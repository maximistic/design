<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html, body {
      width: 100%;
      height: 100%;
      font-family: "PP Neue Montreal";
    }
    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    h1 {
      text-transform: uppercase;
      font-size: clamp(36px, 10vw, 150px);
      font-weight: 200;
      letter-spacing: -1px;
    }
    section.hero {
      width: 100vw;
      height: 100vh;
      background: url(assets/test1.jpg) no-repeat 50% 50%;
      background-size: cover;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .hero h1 {
      font-family: "PP Editorial Old";
      font-weight: lighter;
      color: #fff;
      font-size: clamp(48px, 15vw, 150px);
      letter-spacing: -2px;
    }

    section.info {
      width: 100vw;
      height: auto;
      min-height: 100vh;
      background-color: #000;
      color: #fff;
    }
    .header-row {
      width: 100%;
      height: auto;
      min-height: 15vh;
      padding: 1em;
    }
    .header-row:nth-child(1) {
      display: flex;
      justify-content: flex-start;
      align-items: center;
    }
    .header-row:nth-child(2) {
      display: flex;
      justify-content: flex-end;
      align-items: center;
    }
    .header-info {
      position: relative;
      width: 100%;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      background-color: #000;
      color: #fff;
    }
    .header-info p {
      padding: 1em;
      font-family: 'Courier New', Courier, monospace;
      font-size: clamp(18px, 5vw, 52px);
      font-weight: lighter;
      line-height: 1.4;
    }
    .header-images {
      width: 100%;
      height: auto;
      min-height: 20vh;
      padding: 1em;
      display: flex;
      flex-wrap: wrap;
      gap: 1em;
    }
    .img {
      flex: 1 1 150px;
      min-width: 100px;
      height: 20vh;
    }
    section.pinned {
      position: absolute;
      top: 100vh;
      width: 100%;
      height: 200vh;
      z-index: 2;
    }
    section.whitespace {
      position: relative;
      width: 100%;
      height: 150vh;
      background-color: #000;
      z-index: -1;
    }
    .revealer {
      position: absolute;
      transform: translate(-50%, 0%);
      left: 35%;
      margin-top: 25vh;
      width: clamp(60px, 10vw, 120px);
      height: clamp(60px, 10vw, 120px);
    }
    .revealer .revealer-1 {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #fff;
      clip-path: polygon(45% 0%, 55% 0%, 55% 100%, 45% 100%);
    }
    .revealer .revealer-2 {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #fff;
      transform: rotate(90deg);
      clip-path: polygon(45% 0%, 55% 0%, 55% 100%, 45% 100%);
    }
    section.website-content {
      position: relative;
      width: 100%;
      min-height: 100vh;
      background-color: #fff;
      z-index: 10;
      padding: 2em;
      display: flex;
      align-items: center;
    }
    .website-content h1 {
      font-size: clamp(24px, 5vw, 72px);
      letter-spacing: 0;
      line-height: 1.3;
    }

    html.lenis
    html.lenis body {
      height: auto;
    }
    .lenis.lenis-smooth {
      scroll-behavior: auto !important;
    }
    .lenis.lenis-smooth [data-lenis-prevent] {
      overscroll-behavior: contain;
    }
    .lenis.lenis-stopped {
      overflow: hidden;
    }
    .lenis.lenis-smooth iframe {
      pointer-events: none;
    }

    @media (max-width: 768px) {
      .header-images {
        flex-direction: column;
      }
      .img {
        width: 100%;
        height: 15vh;
      }
      .revealer {
        left: 50%;
        margin-top: 15vh;
      }
      section.whitespace {
        height: 100vh;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <section class="hero">
      <h1>MONTAGE</h1>
    </section>

    <section class="info">
      <div class="header-rows">
        <div class="header-row"><h1>Montage</h1></div>
        <div class="header-row"><h1>Studio</h1></div>
      </div>
    </section>

    <section class="header-info">
      <p>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Exercitationem, facere, molestias vel recusandae sit magni alias ratione dolorem ipsa excepturi ab ipsam quae corporis, nihil culpa porro eos? Veniam, laborum?
      </p>

      <div class="header-images">
        <div class="img"><img src="assets/test1.jpg" loading="lazy"/></div>
        <div class="img"><img src="assets/test1.jpg" loading="lazy"/></div>
        <div class="img"><img src="assets/test1.jpg" loading="lazy"/></div>
        <div class="img"><img src="assets/test1.jpg" loading="lazy"/></div>
        <div class="img"><img src="assets/test1.jpg" loading="lazy"/></div>
      </div>
    </section>

    <section class="whitespace"></section>

    <section class="pinned">
      <div class="revealer">
        <div class="revealer-1"></div>
        <div class="revealer-2"></div>
      </div>
    </section>

    <section class="website-content">
      <h1>
        Lorem ipsum dolor sit amet consectetur adipisicing elit. Quisquam, voluptatibus. Lorem ipsum dolor sit amet consectetur adipisicing elit. Quisquam, voluptatibus.
      </h1>
    </section>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://unpkg.com/@studio-freight/lenis"></script>
  <script>
    const lenis = new Lenis();

    lenis.on("scroll", ScrollTrigger.update);

    gsap.ticker.add((time) => {
      lenis.raf(time * 1000);
    })

    gsap.ticker.lagSmoothing(0);

    gsap.registerPlugin(ScrollTrigger);

    // Responsive animation setup
    function setupAnimations() {
      const isMobile = window.innerWidth < 768;
      
      // Clear all previous ScrollTriggers
      ScrollTrigger.getAll().forEach(trigger => trigger.kill());

      ScrollTrigger.create({
        trigger: '.pinned',
        start: 'top top',
        end: 'bottom top',
        endTrigger: '.whitespace',
        pin: true,
        pinSpacing: false,
      })

      ScrollTrigger.create({
        trigger: ".header-info",
        start: "top top",
        end: "bottom top",
        endTrigger: ".whitespace",
        pin: true,
        pinSpacing: false,
      })

      ScrollTrigger.create({
        trigger: ".pinned",
        start: "top top",
        end: "bottom bottom",
        endTrigger: ".header-info",
        onUpdate: (self) => {
          const rotation = self.progress * 360;
          gsap.to(".revealer", { rotation });
        },
      });

      ScrollTrigger.create({
        trigger: ".pinned",
        start: "top top",
        end: "bottom bottom",
        endTrigger: ".header-info",
        onUpdate: (self) => {
          const progress = self.progress;
          const left = 45 - 45 * progress;
          const right = 55 + 45 * progress;

          const clipPath = `polygon(${left}% 0%, ${right}% 0%, ${right}% 100%, ${left}% 100%)`;

          gsap.to(".revealer-1, .revealer-2", { 
            clipPath: clipPath,
            ease: "none",
            duration: 0,
          });
        },
      });

      ScrollTrigger.create({
        trigger: ".header-info",
        start: "top top",
        end: "bottom 50%",
        scrub: 1,
        onUpdate: (self) => {
          const progress = self.progress;
          const leftValue = isMobile ? 50 : 35;
          const left = leftValue + (isMobile ? 0 : 15) * progress;

          gsap.to(".revealer", {
            left: `${left}%`,
            ease: "none",
            duration: 0,
          })
        }
      })    

      ScrollTrigger.create({
        trigger: ".whitespace",
        start: "top 50%",
        end: "bottom bottom",
        scrub: 1,
        onUpdate: (self) => {
          const scale = 1 + (isMobile ? 8 : 12) * self.progress;
          gsap.to(".revealer", {
            scale,
            ease: "none",
            duration: 0,
          })
        }
      })
    }

    // Initial setup
    setupAnimations();

    // Re-run setup on resize
    window.addEventListener('resize', () => {
      setupAnimations();
    });
  </script>
</body>
</html>